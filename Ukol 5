function Show-Directory($path) {
    while ($true) {
        Clear-Host
        Write-Host "Aktuální cesta: $path"
        $dirs = Get-ChildItem -Path $path -Directory
        $i = 1
        foreach ($dir in $dirs) {
            $files = Get-ChildItem -Path $dir.FullName -File -ErrorAction SilentlyContinue
            if ($files) {
                $min = ($files | Sort-Object Length | Select-Object -First 1).Name
                $max = ($files | Sort-Object Length -Descending | Select-Object -First 1).Name
                Write-Host "$i) $($dir.Name) - Soubory: $($files.Count), Nejmenší: $min, Největší: $max"
            } else {
                Write-Host "$i) $($dir.Name) - Žádné soubory"
            }
            $i++
        }
        Write-Host "`nU - o úroveň výš | Q - konec"
        $input = Read-Host "Volba"
        if ($input -eq 'Q') { break }
        elseif ($input -eq 'U') {
            $parent = Split-Path $path -Parent
            if ($parent) { $path = $parent }
        }
        elseif ($input -match '^\d+$' -and [int]$input -le $dirs.Count) {
            $path = $dirs[[int]$input - 1].FullName
        }
    }
}
Show-Directory (Get-Location)
